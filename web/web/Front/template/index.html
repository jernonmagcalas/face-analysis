<script src="/scripts/jquery.uploadifive.min.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="/styles/uploadifive.css" />
<style type="text/css">
	html, .page { background: #19D197; height: 100%; }
	header { margin-left: 50px; }
	body {
		font: 13px Arial, Helvetica, Sans-serif;
	}
	.analysis { margin-top: 20px; font-size: 15px; display: none; }
	.container { margin: 0 auto; width: 500px; }
	.uploadifive-button {
		margin: 10px auto;
	}
	#queue {
		border: 1px solid #E5E5E5;
		height: 177px;
		overflow: auto;
		margin-bottom: 10px;
		margin: 0 auto;
		padding: 0 3px 3px;
		width: 300px;
	}
	#image img { height: 300px; width: auto; }
	.input-group { margin: 0 auto; width: 300px; }
	.input-group-addon { padding: 0 !important; }
	.url { height: 36px; }
	form { margin:13% auto 0px; }
</style>
<header>
	<h2>Face Scanner</h2>
	<p>let robot agents observe your image</p>
</header>	
<div class="container">
	<form method="post">
		<div id="queue"></div>
		<div id="image">
			<?php if(isset($image)):?>
			<style type="text/css">
			form { margin: 5% auto 0px !important; width: 500px; }
				#queue { display: none; }
				#image { height: 300px; text-align: center; width: 100%; }
			</style>
			<img src="<?php echo $image; ?>">
		<?php endif;?></div>
		<input id="file_upload" name="file_upload" type="file">
		<div class="input-group">
	      <input type="text" class="form-control url" placeholder="url of image" name="url">
	      <div class="input-group-addon"><input type="submit" class="btn" value="submit"></div>
	    </div>
	</form>
	<div class="analysis">
		<div id="age"><strong>AGE:</strong> <span class="value">22 yrs. old</span></div>
		<div id="gender"><strong>GENDER:</strong> <span class="value">Female</span></div>
		<div id="race"><strong>RACE:</strong> <span class="value">Asian</span></div>
		<div id="glasses"><strong>You are wearing a glasses.</strong></div>
		<div id="happy-meter"><strong>HAPPY METER:</strong> <span class="value">89% happy</span></div>
	</div>
</div>

<script type="text/javascript">
	<?php $timestamp = time();?>
	$(function() {
		$('#file_upload').uploadifive({
			'auto'             : true,
			'checkScript'      : 'check-exists.php',
			'formData'         : {
								   'timestamp' : '<?php echo $timestamp;?>',
								   'token'     : '<?php echo md5('unique_salt' . $timestamp);?>'
			                     },
			'queueID'          : 'queue',
			'uploadScript'     : '/',
			'onUploadComplete' : function(file, data) {
				data = JSON.parse(data);

				var glasses = data.analysis[0].face[0].attribute.glass.value == 'None' ? 'You are not wearing a glasses' : 'You are wearing a glasses';

				$('#queue').hide();
				$('#image').html('<img src="' + data.image +'" />');
				$('#image').css({
					'height': '300px',
					'text-align': 'center',
					'width': '100%' });
				$('#age .value').html(data.analysis[0].face[0].attribute.age.value);
				$('#gender .value').html(data.analysis[0].face[0].attribute.gender.value);
				$('#race .value').html(data.analysis[0].face[0].attribute.race.value);
				$('#glasses strong').html(glasses);
				$('#happy-meter .value').html(data.analysis[0].face[0].attribute.smiling.value + '%');
				$('.analysis').show();
			}
		});
	});
</script>